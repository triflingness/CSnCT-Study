## Cookieμ™€ Sessionμ„ μ‚¬μ©ν•λ” μ΄μ 

**λΉ„μ—°κ²°μ„±(connectionless)** λ°©μ‹μΈ HTTP μ νΉμ„±μΌλ΅ μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ μƒνƒλ¥Ό μ•μ§€ λ»ν•©λ‹λ‹¤.
μ΄λ¥Ό HTTPμ λΉ„μ—°κ²°μ§€ν–¥, stateless λΌκ³  ν•©λ‹λ‹¤.

μ΄λ” μ„λ²„μ μμ› λ¶€λ‹΄μ„ λμ–΄λ‚΄μ§€λ§, ν΄λΌμ΄μ–ΈνΈ νμ΄μ§€μ™€ μƒνΈμ‘μ©μ΄ ν•„μ”ν•  κ²½μ°μ—λ” λ§¤λ² μ—°κ²°μ„ ν•΄μ•Όν•©λ‹λ‹¤.

λ”°λΌμ„ μ΄ λ²κ±°λ΅μ›€μ„ ν•΄κ²°ν•κΈ° μ„ν•΄ Cookieμ™€ Sessionμ„ μ΄μ©ν•΄ ν΄λΌμ΄μ–ΈνΈμ μƒνƒ μ •λ³΄λ¥Ό μ €μ¥ν•©λ‹λ‹¤.

> π’΅μƒνƒ μ •λ³΄λ¥Ό κΈ°μ–µν•λ” λ°©λ²• μ¤‘ 'ν† ν°'μ„ μ΄μ©ν•λ” OAuth, JWT(JSON Web Token)λ„ μμµλ‹λ‹¤.
> 
> - OAuth: νμ΄μ¤λ¶, μΉ΄μΉ΄μ¤ν†΅μΌλ΅ λ΅κ·ΈμΈκ°™μ΄ APIλ¥Ό μ‚¬μ©ν•μ—¬ μ™Έλ¶€μ—μ„ ν† ν°μ„ λ°›μ•„μ™€ μ„λ²„μ— μ”μ²­ν•μ—¬ μ ν•λ ν—μ©μ„ μ‚¬μ©ν•  μ μκ² ν•©λ‹λ‹¤.
> - JWT(JSON Web Token): JSON ν•μ‹μΌλ΅ ν† ν°μ„ μ£Όκ³  λ°›μ•„ μΈμ¦ν•λ” κµ¬μ΅°μ…λ‹λ‹¤.

## Cookie

μ„λ²„κ°€ λΈλΌμ°μ €μ—μ„ λ³΄λ‚΄λ” λ¬Έμμ—΄μ…λ‹λ‹¤.

**μ„λ²„κ°€ κ°μ²΄λ¥Ό μ”μ²­**ν•λ©΄ **ν΄λΌμ΄μ–ΈνΈλ” λ™μΌν• λ„λ©”μΈμ—μ„ λ™μΌν• λ°μ΄ν„° λ¬Έμμ—΄μ„  κ°’μ„ μ„¤μ •**ν•΄μ„ μ›λ³Έ μ„λ²„λ΅ λ³΄λƒ…λ‹λ‹¤.

> **λ„λ©”μΈ**  
> ex) domain=whether.domain.com  
> - μΏ ν‚¤κ°€ μ‚¬μ©λλ” Scopeλ¥Ό μ§€μ •ν•©λ‹λ‹¤.  
> - ν΄λΌμ΄μ–ΈνΈμ μΏ ν‚¤ λ„λ©”μΈμ΄ μ΄μ™€ μΌμΉν•μ§€ μ•μΌλ©΄ "λ‹¤λ¥Έ μΏ ν‚¤"λ΅ κ°„μ£Όλλ©° λΈλΌμ°μ €μ—μ„ κ±°λ¶€λ©λ‹λ‹¤.

λΈλΌμ°μ €λ” κ°’μ„ μ €μ¥ν•΄ λ†“μ•λ‹¤κ°€, μ΄μ „μ— μΏ ν‚¤λ¥Ό μ”μ²­ν• μ„λ²„κ°€ μ¬ μ”μ²­ μ‹ μ €μ¥λ λ°μ΄ν„°λ¥Ό ν•¨κ» μ „μ†΅ν•©λ‹λ‹¤.

- μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ

    HTTP μ‘λ‹µ ν—¤λ”λ” Set-Cookie ν—¤λ”λ¥Ό μ΄μ©ν•μ—¬ ν΄λΌμ΄μ–ΈνΈκ°€ μΏ ν‚¤λ¥Ό μƒμ„±ν•λ„λ΅ μ§€μ‹ν•©λ‹λ‹¤. 

    ```jsx
    HTTP/1.0 200 OK
    Content-type: text/html
    Set-Cookie: yummy_cookie=choco
    Set-Cookie: tasty_cookie=strawberry

    [page content]
    ```

- ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„

    μ΄ν›„ HTTP μ”μ²­ ν—¤λ”λ” Cookie ν—¤λ”λ¥Ό μ΄μ©ν•μ—¬ κ·Έλ™μ• μ„λ²„μ—μ„ λ°›μ•λ λ¨λ“  HTTP μΏ ν‚¤ κ°’μ„ ν¬ν•¨ν•μ—¬ λ³΄λƒ…λ‹λ‹¤.

    ```jsx
    GET /sample_page.html HTTP/1.1
    Host: www.example.org
    Cookie: yummy_cookie=choco; tasty_cookie=strawberry
    ```

### μΏ ν‚¤λ” **λ§λ£ λ‚ μ§**μ— λ”°λΌ λ‘ κ°€μ§€ μ ν•μΌλ΅ λ‚λ‰©λ‹λ‹¤.

- **μκµ¬** Cookie
: **ν΄λΌμ΄μ–ΈνΈ λ””μ¤ν¬μ— μ €μ¥**λλ©°  `Expires` **μ†μ„±μ΄ λ…μ‹**λμ–΄ μμΌλ©° λ…μ‹λ λ‚ μ§μ— μ‚­μ λκ±°λ‚ `Max-Ages` μ†μ„±μ— λ…μ‹λ κΈ°κ°„ μ΄ν›„μ— μ‚­μ λ©λ‹λ‹¤.

    β†’ μλ™μ™„μ„±, νμ—… λ³΄μ§€ μ•κΈ°, ...

- **μ„Έμ…** Cookie
: **λ©”λ¨λ¦¬μ— μ €μ¥**λλ©° λ””μ¤ν¬μ— μ €μ¥λμ§€ μ•μµλ‹λ‹¤. `Expires` **μ†μ„±μ΄ ν¬ν•¨λμ–΄ μμ§€ μ•μΌλ©°** λΈλΌμ°μ €κ°€ λ‹«ν μ‹μ λ¶€ν„° μΏ ν‚¤κ°€ μκµ¬μ μΌλ΅ μ‚­μ λ©λ‹λ‹¤.

```jsx
Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT;
```

### μ‚¬μ© λλ” κ³³: μ„Έμ… κ΄€λ¦¬, κ°μΈν™”, νΈλν‚Ή

μ£Όλ΅ λ‘ κ° μ΄μƒμ μ”μ²­μ΄ λ™μΌν• λΈλΌμ°μ €μ—μ„ λ“¤μ–΄μ™”λ” μ§€, μ•„λ‹ μ§€λ¥Ό νλ‹¨ν•  λ• μ‚¬μ©λ©λ‹λ‹¤.  β‡’ μ‚¬μ©μμ λ΅κ·ΈμΈ μƒνƒλ¥Ό μ μ§€ν•  μ μμµλ‹λ‹¤.

- μ„Έμ…κ΄€λ¦¬: μ„λ²„μ— μ €μ¥ν•΄μ•Ό ν•  λ΅κ·ΈμΈ, μ¥λ°”κµ¬λ‹, κ²μ„ μ¤μ½”μ–΄ λ“±μ μ •λ³΄λ¥Ό κ΄€λ¦¬
- κ°μΈν™”: μ‚¬μ©μ μ„ νΈ, ν…λ§ λ“±μ μ„Έν…
- νΈλν‚Ή: μ‚¬μ©μ ν–‰λ™μ„ κΈ°λ΅ν•κ³  λ¶„μ„ν•λ” μ©λ„

## Session

μΌμ • μ‹κ°„λ™μ• λΈλΌμ°μ €λ΅λ¶€ν„° λ“¤μ–΄μ¤λ” μΌλ ¨μ μ”κµ¬λ¥Ό ν•λ‚μ μƒνƒλ΅ λ³΄κ³  κ·Έ μƒνƒλ¥Ό μΌμ •ν•κ² μ μ§€μ‹ν‚¤λ” κΈ°μ 

β†’ μ„λ²„κ°€ ν•΄λ‹Ή μ„λ²„λ΅ μ ‘κ·Όν• **ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹λ³„**ν•λ” λ°©λ²•μΌλ΅μ„ μ›Ή μ„λ²„μ— μ ‘μ†ν• μ‹μ λ¶€ν„° μ›Ή λΈλΌμ°μ €λ¥Ό μΆ…λ£ν–μ„ μ‹μ μ„ ν•λ‚μ λ‹¨μ„λ΅ λ³΄λ” κΈ°μ μ΄λ‹¤.

β†’ λ°μ΄ν„°λ¥Ό μ„λ²„μ— μ €μ¥ν•λ―€λ΅ λ‹¤μμ ν΄λΌμ΄μ–ΈνΈκ°€ λ°λ¦΄ κ²½μ°, μ„λ²„μ— λ¶€λ‹΄μ΄ λ  μ μλ‹¤.

### Session λ™μ‘

<p align="center">
  <img src="https://github.com/triflingness/CSnCT-Study/blob/dab374d724e91b7c299d5ea95382d7e473510ecc/Network/imgs/4.%20cookie%20vs%20session/session_flow.png">
</p>

1. μ‚¬μ©μκ°€ μ„λ²„λ΅ μ ‘μ†μ„ ν•©λ‹λ‹¤.
2. μ„λ²„λ” request headerμ—μ„ cookieλ¥Ό ν™•μΈν•΄ session-idκ°€ μλ” μ§€ ν™•μΈν•©λ‹λ‹¤.
3. session-idκ°€ μ—†μΌλ©΄ μƒλ΅μ΄ μ„Έμ…μ„ μƒμ„±ν• ν›„, session-idλ¥Ό λ°κΈ‰ν•©λ‹λ‹¤.

    μ΄λ•, ν΄λΌμ΄μ–ΈνΈλ§λ‹¤ κ³ μ ν• session-idλ¥Ό λ¶€μ—¬ν•©λ‹λ‹¤.

    3-2. session-idκ°€ μμΌλ©΄ (7).μΏ ν‚¤ κ²€μ¦μ„ ν•©λ‹λ‹¤.

4. λ°κΈ‰ν• session-idλ¥Ό Set-cookie ν—¤λ”μ— λ„£κ³  μ‚¬μ©μμ—κ² response λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•©λ‹λ‹¤.
5. μ‚¬μ©μ λΈλΌμ°μ €λ” λ©”λ¨λ¦¬μ— session-idλ¥Ό μ €μ¥ν•©λ‹λ‹¤.
6. μ‚¬μ©μλ” μΈμ¦μ΄ ν•„μ”ν• requestλ§λ‹¤ μΏ ν‚¤λ¥Ό Cookie ν—¤λ”μ— λ‹΄μ•„ λ³΄λƒ…λ‹λ‹¤.
7. μ„λ²„λ” μΏ ν‚¤λ¥Ό ν™•μΈν•κ³  μ„Έμ… μ €μ¥μ†μ—μ„ λ§¤μΉ­μ΄ λλ©΄ κ·Έμ— λ§λ” response λ©”μ‹μ§€λ¥Ό λ³΄λƒ…λ‹λ‹¤.

## Cookie μ™€ Session μ°¨μ΄

[cookieμ™€ session μ°¨μ΄](https://www.notion.so/0d1d22876e474bde9f1e86c8a12ef246)

## μΊμ‹

μ΄λ―Έμ§€λ‚ css, jsνμΌ λ“±μ„ λΈλΌμ°μ €λ‚ μ„λ²„ μ• λ‹¨μ— μ €μ¥ν•΄λ†“κ³  μ‚¬μ©ν•λ” κ²ƒ

---

## μ§λ¬Έ

1. μΏ ν‚¤μ™€ μ„Έμ…μ„ λΉ„κµν•΄μ£Όμ„Έμ”.

//μλ„ : λΌμ΄ν” μ‚¬μ΄ν΄
  
  
---
ref)

[https://tansfil.tistory.com/58](https://tansfil.tistory.com/58)

[https://devuna.tistory.com/23](https://devuna.tistory.com/23)

[https://www.cisco.com/c/ko_kr/support/docs/security/web-security-appliance/117925-technote-csc-00.html](https://www.cisco.com/c/ko_kr/support/docs/security/web-security-appliance/117925-technote-csc-00.html)

HTTP ν—¤λ” - [https://developer.mozilla.org/ko/docs/Web/HTTP/Headers](https://developer.mozilla.org/ko/docs/Web/HTTP/Headers)

HTTP μΏ ν‚¤ - [https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies)

OAuth - [https://interconnection.tistory.com/76?category=616434](https://interconnection.tistory.com/76?category=616434)
